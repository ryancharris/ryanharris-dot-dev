---
title: "Hooks Revisited: useRef"
date: "2020-03-13"
published: true
tags:
  - "react"
  - "hooks"
  - "javascript"
attachments:
---

import { Link } from "gatsby"

### What are refs?

If you read <Link to="/hooks-uselayouteffect">my last article</Link>, about the differences between `useEffect` and `useLayoutEffect`, you may remember seeing some code snippets that looked like this:

```javascript
useEffect(() => {
  const greenSquare = document.querySelector(".App__square")
  greenSquare.style.transform = "translate(-50%, -50%)"
  greenSquare.style.left = "50%"
  greenSquare.style.top = "50%"
})

useLayoutEffect(() => {
  const greenSquare = document.querySelector(".App__square")
  greenSquare.style.transform = "translate(-50%, -50%)"
  greenSquare.style.left = "50%"
  greenSquare.style.top = "50%"
})
```

In these examples, we're directly accessing the DOM in order to select and manipulate an element (i.e. `.App__square`), which is considered an [anti-pattern](https://en.wikipedia.org/wiki/Anti-pattern) in React because frameworks manage UI state via a [virtual DOM](https://reactjs.org/docs/faq-internals.html#what-is-the-virtual-dom) and comparing it to the browser's. Then, the framework handles the work of [reconciling](https://reactjs.org/docs/reconciliation.html) the two. However, there **are** cases where we need may need to break this rule. That's where `refs` come in.

While the React docs cite a few examples where using `refs` would be appropriate, including managing focus, triggering animations, and working with third party libraries, they also warn against overusing them.

> Avoid using refs for anything that can be done declaratively. [[React docs]](https://reactjs.org/docs/refs-and-the-dom.html#when-to-use-refs)

For a practical example of how to use `refs` in your React app, [checkout my previous article about rebuilding a search UI](https://ryanharris.dev/2019-10-27-redoing-search/) using `refs` and React Context. We'll also cover the ins and outs of Context in the next article in this series.

In the next section, we'll look more closesly at the `useRef` hook and its syntax.

### Anatomy of useRef

> ...useRef is like a “box” that can hold a mutable value... [[React docs]](https://reactjs.org/docs/hooks-reference.html#useref)

The `useRef` hook only takes one argument: its initial value. This value can be [any valid JavaScript primitve](https://developer.mozilla.org/en-US/docs/Glossary/Primitive) or JSX element. Here are a few examples:

```javascript
// String value
const stringRef = useRef("initial value")

// Array value
const arrayRef = useRef([1, 2, 3])

// Object value
const objectRef = useRef({
  firstName: "Ryan",
  lastName: "Harris",
})
```

Essentially, you can store any value in your `ref` and then access it via the `ref`'s `current` field. For example, if we logged out the variables from the snippet above, we would see:

```javascript
console.log(stringRef)
// {
//   current: "initial value"
// }

console.log(arrayRef)
// {
//   current: [1, 2, 3]
// }

console.log(objectRef)
// {
//   current: {
//     firstName: 'Ryan',
//     lastName: 'Harris'
//   }
// }
```

As I mentioned in the intro, `refs` are primarily used for accessing the DOM. Below is an example of how you would define and use a `ref` in the context of a `class` component:

```javascript
class MyComponent extends React.Component {
  // TODO: Define this example
}
```

To do the same exact thing using hooks, we would leverage `useRef` like you see in the snippet below:

```javascript
function MyComponent {
  // TODO: Define this example
}
```

Hopefully, those examples were relatively straightforward. Just remember: `refs` are simply a "reference" to a DOM element -- it's right in the name!

`refs` also have another less-known use case. Since a `ref`'s value can be any JavaScript primitve, you can also use `refs` as simple data stores. Usually, you would use `useState` for something like that, however, there are time where you want to avoid unecessary re-renders but cache a value. Updating values in state cause a re-render each time, whereas updating `refs` **do not cause the component to update**. This is a subtle, but important distinction.

### In practice

EXAMPLE 1: Using ref for DOM manipulation

<iframe
  src="https://codesandbox.io/embed/serene-sunset-z80cl?fontsize=14&hidenavigation=1&theme=dark"
  style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"
  title="hooks/useRef (DOM)"
  allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb"
  sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"
></iframe>

EXAMPLE 2: Using ref as data store

<iframe
  src="https://codesandbox.io/embed/fancy-hooks-cxw57?fontsize=14&hidenavigation=1&theme=dark"
  style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"
  title="hooks/useRef (Data)"
  allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb"
  sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"
></iframe>
